# COMP2113GroupProject
This is the repo for COMP2113 Group Project (group 157)
## Group Member
Tan Lihui, Yuan Jing

## Game Description
This is a simple round-based strategy, player-versus-player game. Setting in a war background, two players act as commanders of two hostile countries, who can control each side's army and factories to win the war (occupy enermy's capital). 
Once the game starts, it will display a 2D grid map. Each grid has a terrain feature which is not changable. Different types of terrain have different features, one of which could be occupied by troops or buildings(which are called Occupiers).  
Two players could act in turn, including moving troops(maybe starting a battle), healing soldiers/buildings, generating troops, building factories.  
Note: The player can just choose make one change in one turn. i.e. He cannot do two things in one turn.  

## Rules: 
### New game and load previous record:  
Before starting playing, players can choose to start a new game or reload previous record.  
However, the players need to enter the map/record file name (name without extension).  
When players quit in the middle of the game, status of one game can be chosed to store as .txt files in ./savings/.

### Control:
-use "w", "s", "a", "d" to move your cursor up, down, left, right respectively.  
-press "e" to confirm / proceed. It is used to choose occupiers, destinations, etc.  
-press "q" to return to previous step. 
-press "f" to skip a turn. 
-use "z", "x", "c", "v" to produce soldiers, engineers, lavs and tanks. 
-press esc to quit game.  

### Terrain:
There will be three types of terrains.   
-Land(white colored `地` or white square): normal area that can be occupied with troops or factories. Each land has its peoductivity level.  
-Sea(blue colored `海` or blue square): forbidden area, which means player cannot choose it as troops' destination. Nothing can access this area.  
-Hill(green colored `山` or green square): forbidden area. Same as Sea. 


### Buildings:
-Factory(`厰`) is build with an engineer and 1000 money. It has the function of generating troops. Factories have an attack point of 1 and life point of 20.  
-Capital(`都`) is the heart of one country(one player). It also has the function of generating troops. Capitals have an attack point of 1 and life point of 20. More importantly, Once the capital is occupied by the enermy（the other player), you lose.  

-Generating new troops: Players can choose to generate new troops in a building's neighbouring area: 3* 3 grids whose center is the building.  
-Attack point: the hurt level it can cause to its attacher in each winning round.  
-Life point: How many hurt it can bear before destroyed. 

### Money:
-Money is accumulatively generated each round by the sum of the productivity of terrain where this player's capital and factories occupy.  
-Two players each will have 200 money initially. (This can be altered manually by changing the map text files) 

### Troops:
There are four types of troops with different functions or capabilities.  
-Soldier(`兵`) soldiers have an attack point of 2, a life point of 2, and a portability of 1, and a cost of 100.  
-Engineer(`工`): engineers have an attack point of 1, a life point of 2, and a portability of 1, and a cost of 150. Its primary function is to build a factory, which means players can spend money to update `工` to `厰`.  
-Light Armoured Vehicle(LAV) (`車`): LAVs have an attack point of 4, a life point of 3, and a portability of 2, and a cost of 300.  
-Tank (`炮`): Tanks have an attack point of 6, a life point of 5, and a portability of 1, and a cost of 600. 
 
-Attack point: the hurt level it can cause to his enermy in each winning round.  
-Life point: How many hurt points it can bear before its death.  
-Portability:  
1: it can move to 3* 3 grids whose center is the troops' location.  
2: it can move to 5* 5 grids whose center is the troops' location.  
-Cost: How much it needs to deduct from accumulated money.


### Battle procedure:
In a certain battle, it could have several rounds to cause one's death, which is an end of a battle.  
Each round's result is a random event generated by computer.  
In each round, the winer will cause the loser's life point decrease by the attack point of the winner.  
Once one side's life point is 0 (or < 0 in coding level), it dies. The other side wins and occupies this grid.

### Recover Life:
Both Buildings and troops' life level can be recovered to its maximum level with the same cost of generating it. Additionlly, The recover life cost of capital is 1000.

### Winning condition:
One player occupies the other one's capital.

## Features
### Immediate control: 
the whole process (including start page, game page, exit page, etc. ) is controlled by keyboard events. Various listeners are used to keep track of user control in different stages. Upon keyboard events, screen manager will conduct behaviors such as refreshing screen or updating certain information on the screen. 

### Graphical game interface: 
the game utilises symbols and ANSI escape sequence to implement a colorful graphical map and different Occupiers (buildings and troops).

### Process (partially) organised in classes: 
this segments the whole game process into work achieved by different objects. Like functions, it also simplifies co-ordination between groupmates. Classes are more convient in that it can include many data and functions. One may simply include a header file without implementation in order to use features not yet implemented by the other groupmate.

#### 1. Random game settings and events:
In each battle, the two sides (attacker & defender) will perform multiple attacks, in each attack, chance decides who attacks whom. This is assure a better balance between different types of troops. 

#### 2. Data structures for storing game status: 
##### Most data are organized in classes, for example:
-location(x, y), graphical representation, type of Point(soldier, engineer, tank, ...), attack, life, etc. in Point. 
-part of the data above stored in Passer classes.
-New Occupier data stored in Initialiser and ConfigInitiator.
-Game status (turn-counter, money-counter) stored in GameMediator
##### Two-dimensional Array of Point* used in Map to store the game map (like a chessboard)
##### Struct used to organize data as a "package"
##### Union used in Point so as to save memory

#### 3. Dynamic memory management: 
##### The two-dimensional array map is `new`ed according to the height and width stated in maps or savings files.
##### After a Point is discarded (Occupier destroyed or Terrain occupierd), the union Pass and the information OccupierPasser / TerrainPasser in the union will be `delete`ed so as to release the memory. 
##### Other data, such as the array in Map, initialization data in Initialiser and ConfigInitiator and game status in GameMediator are also deleted (in destructors); however, these all live until the end of the program, therefore it is not that important.

#### 4. File input/output
-input: maps or game status records (from archive at last exit time).  
-output: to archive game status when exiting with save chosen.  

#### 5. Program codes in multiple files: 
Different functions and classes packed in different .cpp files, they rely on each other via .h files.


### Non-standard C/C++ libraries:
termio.h: used in GameListener.cpp, used to listen to keyboard events

### Compilation and execution instructions:
Make main  
./main  
Please include ./maps/ and ./savings/ directories, these two are needed to access maps and savings.  
Note: our template map is named as "Map1.txt"  
(If you feel not good about map filled with Chinese characters, you may want to uncomment Symbol.h line 7-9 and comment line 14-16; however, this does not always work well.)
